<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.3/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.3/addons/p5.dom.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.3/addons/p5.sound.min.js"></script>
    <script src="../filter/Dithering.js"></script>
    <meta charset="utf-8" />
    <style>
        html, body {
            margin: 0;
            padding: 0;
        }
        canvas {
            display: block;
        }
    </style>
  </head>
  <body>
    <script>
        let img;


        function preload() {
            img = loadImage("../images/kitten.jpg");
        }

        function setup() {
            createCanvas(img.width * 1, img.height * 1)
            image(img, 0, 0)
            loadPixels()
            img.loadPixels()
            dither(img)
            updatePixels()
        }

        function dither(img) {
            applyOrderedDither({data: img.pixels, width: img.width, height: img.height})

            /*let ditherMatrix = [
                [1, 49, 13, 61, 4, 52, 16, 64],
                [33, 17, 45, 29, 36, 20, 48, 32],
                [9, 57, 5, 53, 12, 60, 8, 56],
                [41, 25, 37, 21, 44, 28, 40, 24],
                [3, 51, 15, 63, 2, 50, 14, 62],
                [35, 19, 47, 31, 34, 18, 46, 30],
                [11, 59, 7, 55, 10, 58, 6, 54],
                [43, 27, 39, 23, 42, 26, 38, 22]
            ];

            for (let y = 0; y < img.height; y++) {
                for (let x = 0; x < img.width; x++) {
                    let index = (x + y * img.width) * 4;
                    let r = img.pixels[index];
                    let g = img.pixels[index + 1];
                    let b = img.pixels[index + 2];
                    let grayscale = 0.299 * r + 0.587 * g + 0.114 * b;
                    let ditherValue = (grayscale / 255) * 65;
                    if (ditherValue > ditherMatrix[x % 8][y % 8]) set(x, y, color(255));
                    else set(x, y, color(0));
                }
            }*/
        }  
    </script>
  </body>
</html>
